// ===================================================================
// SISTEMA DE EXPORTACIÓN PDF ARVIC - VERSIÓN FINAL COMPLETA
// Replica EXACTAMENTE el diseño de la imagen de referencia objetivo
// ===================================================================

/**
 * COLORES CORPORATIVOS ARVIC 
 */
const ARVIC_COLORS = {
    primary: '#1976D2',      // Azul principal de los headers
    secondary: '#2196F3', 
    light: '#E3F2FD',       // Azul muy claro para filas alternadas
    dark: '#0D47A1',
    gray: '#666666',
    lightGray: '#F5F5F5',   // Gris para filas alternadas
    white: '#FFFFFF',
    black: '#000000',
    textGray: '#555555'     // Para texto general
};

const ARVIC_LOGO_BASE64 = 'data:image/png;base64,' + 
'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';

/**
 * CONFIGURACIÓN PDF OPTIMIZADA
 */
const PDF_CONFIG = {
    margin: 20,
    headerHeight: 95,       // Más espacio para header completo con metadata
    logoSize: 40,
    titleFontSize: 18,
    subtitleFontSize: 12,
    headerFontSize: 10,
    dataFontSize: 10,       // Aumentado de 9 a 10
    metadataFontSize: 9,    // Aumentado de 8 a 9
    lineHeight: 14,         // Aumentado de 12 a 14
    pageFormat: 'a4',
    orientation: 'landscape'
};

const PDF_CONFIG_OPTIMIZED = {
    ...PDF_CONFIG, // Mantener configuración existente
    dataFontSize: 9,     // Reducido de 10 a 9 para más contenido
    headerFontSize: 10,  // Reducido de 11 a 10
    margin: 15,          // Reducido de 20 a 15 para más espacio
    headerHeight: 45     // Reducido de 50 a 45
};

/**
 * CLASE PRINCIPAL - EXPORTADOR PDF ARVIC CORREGIDO
 */
class ARVICPDFExporter {
    constructor() {
        this.loadJsPDF();
    }

    /**
     * Cargar jsPDF si no está disponible
     */
    async loadJsPDF() {
        if (typeof window.jspdf === 'undefined') {
            const script = document.createElement('script');
            script.src = 'https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js';
            document.head.appendChild(script);
            
            return new Promise((resolve) => {
                script.onload = () => {
                    this.jsPDF = window.jspdf.jsPDF;
                    resolve();
                };
            });
        } else {
            this.jsPDF = window.jspdf.jsPDF;
        }
    }

    /**
     * FUNCIÓN PRINCIPAL - Exportar datos a PDF
     */
    async exportToPDF(config, data, headers, metadata = {}) {
        await this.loadJsPDF();
        
        console.log('🎯 Iniciando exportación PDF optimizada:', {
            reportType: config.reportType,
            dataCount: data.length,
            headers: headers,
            metadata: metadata
        });
        
        const doc = new this.jsPDF({
            orientation: 'landscape',
            unit: 'mm',
            format: 'a4'
        });

        // Configurar documento
        this.setupDocument(doc, config);
        
        // Añadir header completo (logo + título + metadata)
        this.addCompleteHeader(doc, config, metadata);
        
        // Añadir tabla con datos (ya incluye footers en cada página)
        this.addDataTable(doc, data, headers, config);
        
        // NOTA: No llamar addFooter aquí porque ya se llama en addDataTable
        
        // Generar nombre de archivo y descargar
        const fileName = this.generateFileName(config.reportType, metadata);
        doc.save(fileName);
        
        // Notificación de éxito
        if (window.NotificationUtils) {
            window.NotificationUtils.success(`PDF generado exitosamente: ${fileName}`);
        }
        
        return fileName;
    }

    /**
     * Configurar propiedades del documento
     */
    setupDocument(doc, config) {
        doc.setProperties({
            title: `${config.title} - ARVIC`,
            subject: 'Reporte generado automáticamente',
            author: 'Sistema ARVIC',
            creator: 'Portal Administrativo ARVIC'
        });
    }

    /**
     * Añadir header completo (espaciado ultra-compacto como imagen objetivo)
     */
    addCompleteHeader(doc, config, metadata) {
        const pageWidth = doc.internal.pageSize.getWidth();
        
        // === LOGO REAL DE ARVIC (lado izquierdo) ===
        this.addARVICLogo(doc, 25, 22);
        
        // === TÍTULO PRINCIPAL (centro) ===
        const titleText = this.getTitleByReportType(config.reportType);
        doc.setTextColor(ARVIC_COLORS.primary);
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(PDF_CONFIG.titleFontSize);
        doc.text(titleText, pageWidth / 2, 30, { align: 'center' });
        
        // Subtítulo empresa
        doc.setTextColor(ARVIC_COLORS.textGray);
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(PDF_CONFIG.subtitleFontSize);
        doc.text('GRUPO IT ARVIC', pageWidth / 2, 40, { align: 'center' });
        
        // === LÍNEA SEPARADORA ===
        doc.setDrawColor(ARVIC_COLORS.primary);
        doc.setLineWidth(0.8);
        doc.line(PDF_CONFIG.margin, 48, pageWidth - PDF_CONFIG.margin, 48);
        
        // === METADATA COMPLETA (pasando reportType) ===
        this.addCompleteMetadataSection(doc, metadata, 52, config.reportType);
    }

    addSimpleLogoFallback(doc, x, y) {
        // Círculo azul
        doc.setFillColor(ARVIC_COLORS.primary);
        doc.circle(x, y, 15, 'F');
        
        // Letra "A" blanca
        doc.setTextColor(ARVIC_COLORS.white);
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(20);
        doc.text('A', x, y + 5, { align: 'center' });
        
        // Texto al lado
        doc.setTextColor(ARVIC_COLORS.black);
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(8);
        doc.text('GRUPO IT', x + 20, y - 5);
        
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(16);
        doc.text('ARVIC', x + 20, y + 8);
    }

    /**
     * Añadir logo real de ARVIC (replicando el diseño exacto)
     */
    addARVICLogo(doc, x, y) {
        try {
            // El logo completo incluye el círculo + texto
            // Tamaño ajustado para que se vea bien (puedes modificar el ancho/alto)
            const logoWidth = 70;  // Ajusta según necesites
            const logoHeight = 20; // Ajusta según necesites
            
            doc.addImage(
                ARVIC_LOGO_BASE64, 
                'PNG', 
                x - 10,           // Posición X (ajusta si necesitas)
                y - 10,           // Posición Y (ajusta si necesitas)
                logoWidth, 
                logoHeight
            );
        } catch (error) {
            console.error('❌ Error cargando logo:', error);
            // Fallback: usar logo simple si falla
            this.addSimpleLogoFallback(doc, x, y);
        }
    }

    /**
     * Obtener título según tipo de reporte
     */
    getTitleByReportType(reportType) {
        const titles = {
            'pago-consultor-general': 'REPORTE GENERAL DE PAGOS',
            'pago-consultor-especifico': 'REPORTE DE PAGO A CONSULTOR',
            'cliente-soporte': 'REPORTE DE SOPORTE AL CLIENTE',
            'remanente': 'REPORTE REMANENTE',
            'proyecto-general': 'REPORTE GENERAL DE PROYECTOS',
            'proyecto-cliente': 'REPORTE DE PROYECTO',
            'proyecto-consultor': 'REPORTE DE CONSULTOR - PROYECTOS'
        };
        
        return titles[reportType] || 'REPORTE ARVIC';
    }

    /**
     * Añadir sección de metadata completa (espaciado mínimo)
     */
    addCompleteMetadataSection(doc, metadata, startY, reportType) {
        const pageWidth = doc.internal.pageSize.getWidth();
        let yPos = startY;
        
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(PDF_CONFIG.metadataFontSize);
        doc.setTextColor(ARVIC_COLORS.textGray);
        
        // Determinar qué información mostrar según el tipo de reporte
        const shouldShowCliente = this.shouldShowClienteInfo(reportType, metadata);
        const shouldShowConsultor = this.shouldShowConsultorInfo(reportType, metadata);
        
        let leftSideLines = [];
        
        // === LADO IZQUIERDO (información de filtros) ===
        
        // Cliente (solo si debe mostrarse)
        if (shouldShowCliente) {
            const clienteText = (metadata.cliente && metadata.cliente !== 'Todos los clientes') 
                ? `Cliente: ${metadata.cliente}` 
                : 'Cliente: N/A';
            leftSideLines.push(clienteText);
        }
        
        // Consultor (solo si debe mostrarse)  
        if (shouldShowConsultor) {
            const consultorText = (metadata.consultor && metadata.consultor !== 'Todos los consultores') 
                ? `Consultor: ${metadata.consultor}` 
                : 'Consultor: N/A';
            leftSideLines.push(consultorText);
        }
        
        // Dibujar líneas del lado izquierdo
        leftSideLines.forEach((line, index) => {
            doc.text(line, PDF_CONFIG.margin, yPos + (index * 4));
        });
        
        // === LADO DERECHO ===
        const fecha = new Date().toLocaleDateString('es-MX', {
            day: 'numeric',
            month: 'long',
            year: 'numeric'
        });
        doc.text(`Generado: ${fecha}`, pageWidth - PDF_CONFIG.margin, yPos, { align: 'right' });
        
        // Período (con texto mejorado)
        const periodoText = (metadata.mes && metadata.mes !== 'Todos los períodos') 
            ? `Período: ${metadata.mes}` 
            : 'Período: No seleccionado'; // CAMBIADO: ya no dice "N/A"
        doc.text(periodoText, pageWidth - PDF_CONFIG.margin, yPos + 4, { align: 'right' });
    }

    /**
     * NUEVA FUNCIÓN: Determinar si mostrar información de Cliente
     */
    shouldShowClienteInfo(reportType, metadata) {
        // Reportes que NO deben mostrar "Cliente N/A":
        const reportesOmitirCliente = [
            'pago-consultor-general',    // Reporte General de Pagos
            'pago-consultor-especifico', // Reporte De Pago A Consultor  
            'proyecto-general',          // Reporte General de Proyectos
            'proyecto-consultor'         // Reporte De Consultor - Proyectos
        ];
        
        // Si es un reporte que debe omitir cliente Y no hay cliente seleccionado, no mostrar
        if (reportesOmitirCliente.includes(reportType)) {
            // Solo mostrar si hay un cliente específico seleccionado
            return metadata.cliente && metadata.cliente !== 'Todos los clientes';
        }
        
        // Para otros reportes, mostrar siempre
        return true;
    }

    /**
     * NUEVA FUNCIÓN: Determinar si mostrar información de Consultor
     */
    shouldShowConsultorInfo(reportType, metadata) {
        // Reportes que NO deben mostrar "Consultor N/A":
        const reportesOmitirConsultor = [
            'pago-consultor-general',  // Reporte General de Pagos
            'cliente-soporte',         // Reporte De Soporte Al Cliente
            'proyecto-general',        // Reporte General de Proyectos  
            'proyecto-cliente'         // Reporte De Proyecto (Cliente)
        ];
        
        // Si es un reporte que debe omitir consultor Y no hay consultor seleccionado, no mostrar
        if (reportesOmitirConsultor.includes(reportType)) {
            // Solo mostrar si hay un consultor específico seleccionado
            return metadata.consultor && metadata.consultor !== 'Todos los consultores';
        }
        
        // Para otros reportes, mostrar siempre
        return true;
    }

    /**
     * Añadir tabla de datos con mejor separación entre totales y mensaje
     */
    addDataTable(doc, data, headers, config) {
        const startY = PDF_CONFIG.headerHeight + 1;
        const pageWidth = doc.internal.pageSize.getWidth();
        const tableWidth = pageWidth - (PDF_CONFIG.margin * 2);
        
        console.log('📊 addDataTable:', {
            reportType: config.reportType,
            dataLength: data.length,
            headers: headers
        });
        
        // 🔧 TRANSFORMAR DATOS SI ES REMANENTE
        let processedData = data;
        let processedHeaders = headers;
        
        if (config.reportType === 'remanente') {
            console.log('📊 Usando estructura jerárquica completa para remanente');
            
            const bottomMargin = 50;

            // 1. Extraer datos editables
            extraerDatosEditablesCorrectos();
            
            // 2. Transformar datos (ahora retorna { soportes: [], proyectos: [] })
            const transformed = this.transformRemanenteDataForPDF(window.editablePreviewData || {});
            
            console.log('📊 Datos transformados:', {
                soportes: transformed.soportes?.length || 0,
                proyectos: transformed.proyectos?.length || 0
            });
            
            console.log('📁 Array de proyectos después de transformación:', transformed.proyectos);

            // 3. Generar reporte multi-página con AMBAS secciones
            this.generateRemanenteMultiPageReport(doc, transformed.soportes, config, startY, transformed.proyectos);
            
            return;
        }
        
        // Calcular anchos de columna
        const columnWidths = this.calculateOptimalColumnWidths(processedHeaders, tableWidth, config.reportType);
        
        console.log('📊 Configuración final:', {
            headers: processedHeaders,
            columnWidths: columnWidths,
            dataLength: processedData.length
        });
        
        // Dibujar headers
        this.drawTableHeaders(doc, processedHeaders, columnWidths, startY);
        
        // Dibujar filas
        let currentY = startY + 12;
        const bottomMargin = 50;
        
        processedData.forEach((row, index) => {
            // Calcular altura necesaria
            const estimatedHeight = config.reportType === 'remanente' ? 18 : 14;
            
            // Verificar nueva página
            if (currentY + estimatedHeight > doc.internal.pageSize.getHeight() - bottomMargin) {
                this.addFooter(doc);
                doc.addPage();
                currentY = 30;
                this.drawTableHeaders(doc, processedHeaders, columnWidths, currentY);
                currentY += 12;
            }
            
            // Dibujar fila según tipo
            let actualHeight;
            if (config.reportType === 'remanente') {
                actualHeight = this.drawRemanenteDataRow(doc, row, processedHeaders, columnWidths, currentY, index);
            } else {
                actualHeight = this.drawDataRow(doc, row, processedHeaders, columnWidths, currentY, index, config.reportType);
            }
            
            currentY += actualHeight + 1;
        });
        
        // Añadir totales
        if (config.showTotals && processedData.length > 0) {
            currentY += 10;
            
            if (currentY + 30 > doc.internal.pageSize.getHeight() - bottomMargin) {
                this.addFooter(doc);
                doc.addPage();
                currentY = 30;
            }
            
            this.addSeparatedTotals(doc, processedData, pageWidth, currentY, config.reportType);
            
            const messageY = currentY + 25;
            doc.setFont('helvetica', 'italic');
            doc.setFontSize(8);
            doc.setTextColor(ARVIC_COLORS.black);
            doc.text('* Totales calculados con valores modificados en vista previa', 
                    pageWidth - PDF_CONFIG.margin, messageY, { align: 'right' });
        }
        
        // Footer final
        this.addFooter(doc);
    }

    /**
     * NUEVA FUNCIÓN: Estimar altura de fila antes de dibujarla
     */
    estimateRowHeight(doc, rowData, headers, columnWidths, reportType) {
        let maxLines = 1;
        
        headers.forEach((header, index) => {
            const width = columnWidths[index];
            let cellValue = this.getCellValue(rowData, header, reportType);
            const lines = this.splitTextToFitWidth(doc, cellValue.toString(), width - 8);
            
            if (lines.length > maxLines) {
                maxLines = lines.length;
            }
        });
        
        return Math.max(14, maxLines * 4); // 12mm mínimo, 4mm por línea adicional
    }

    /**
     * Añadir totales separados (replicando diseño exacto de imagen 1)
     */
    addSeparatedTotals(doc, data, pageWidth, y, reportType) {
        let totalHours = 0;
        let totalAmount = 0;
        
        // 🔧 CÁLCULO ESPECIAL PARA REPORTE REMANENTE
        if (reportType === 'remanente') {
            console.log('📊 Calculando totales para reporte remanente');
            
            data.forEach(row => {
                // Sumar total de horas de cada módulo
                totalHours += parseFloat(row.totalHoras || 0);
                
                // Sumar totales de todas las semanas
                const semanaKeys = Object.keys(row).filter(key => key.startsWith('semana'));
                semanaKeys.forEach(semanaKey => {
                    if (row[semanaKey] && row[semanaKey].total) {
                        totalAmount += parseFloat(row[semanaKey].total || 0);
                    }
                });
            });
            
            console.log(`📊 Totales remanente calculados: ${totalHours} hrs, $${totalAmount}`);
        } else {
            // 📋 CÁLCULO NORMAL PARA OTROS REPORTES
            totalHours = data.reduce((sum, row) => {
                return sum + parseFloat(row.editedTime || row.tiempo || row.hours || 0);
            }, 0);
            
            totalAmount = data.reduce((sum, row) => {
                return sum + parseFloat(row.editedTotal || row.total || 0);
            }, 0);
        }
        
        // Dibujar totales
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(13);
        doc.setTextColor(ARVIC_COLORS.primary);
        
        doc.text(`Total Horas: ${totalHours.toFixed(1)} hrs`, 
                pageWidth - PDF_CONFIG.margin, y, { align: 'right' });
        
        doc.text(`Total Monto: ${totalAmount.toLocaleString('es-MX', { minimumFractionDigits: 2 })}`, 
                pageWidth - PDF_CONFIG.margin, y + 18, { align: 'right' });
    }


    /**
     * Calcular anchos de columna optimizados según tipo de reporte
     */
    calculateOptimalColumnWidths(headers, tableWidth, reportType) {
        const columnCount = headers.length;
        
        switch (reportType) {
            case 'pago-consultor-general':
            case 'pago-consultor-especifico':
                return [
                    tableWidth * 0.08, tableWidth * 0.15, tableWidth * 0.25, 
                    tableWidth * 0.20, tableWidth * 0.10, tableWidth * 0.10, tableWidth * 0.12
                ];
                
            case 'cliente-soporte':
                return [
                    tableWidth * 0.35, tableWidth * 0.25, tableWidth * 0.15, 
                    tableWidth * 0.15, tableWidth * 0.10
                ];
                
            case 'proyecto-cliente':
                return [
                    tableWidth * 0.40, tableWidth * 0.20, tableWidth * 0.20, tableWidth * 0.20
                ];
                
            case 'remanente':
                console.log('📊 Calculando anchos para 5 semanas');
                
                const totalColumnWidth = tableWidth * 0.15;
                const weekAreaWidth = tableWidth * 0.85;
                const numberOfWeeks = 5;  // FIJO: siempre 5 semanas
                const weekColumnWidth = weekAreaWidth / numberOfWeeks;
                const subColumnWidth = weekColumnWidth / 4;
                
                const widths = [totalColumnWidth];
                
                // 5 semanas × 4 subcolomnas = 20 columnas adicionales
                for (let semana = 1; semana <= numberOfWeeks; semana++) {
                    widths.push(subColumnWidth, subColumnWidth, subColumnWidth, subColumnWidth);
                }
                
                console.log(`📊 Anchos calculados para ${numberOfWeeks} semanas`);
                return widths;
                
            default:
                const standardWidth = tableWidth / columnCount;
                return Array(columnCount).fill(standardWidth);
        }
    }

    /**
     * Dibujar headers de tabla (con bordes más sutiles y consistentes)
     */
    drawTableHeaders(doc, headers, columnWidths, y) {
        let currentX = PDF_CONFIG.margin;
        
        headers.forEach((header, index) => {
            const width = columnWidths[index];
            
            // Fondo azul corporativo
            doc.setFillColor(ARVIC_COLORS.primary);
            doc.rect(currentX, y, width, 12, 'F');
            
            // Bordes sutiles (más delgados y grises)
            doc.setLineWidth(0.2);
            doc.setDrawColor(200, 200, 200); // Gris claro
            doc.rect(currentX, y, width, 12);
            
            // Texto del header (corregir "TARIFA de Modulo" a solo "TARIFA")
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(PDF_CONFIG.headerFontSize);
            doc.setTextColor(ARVIC_COLORS.white);
            
            let headerText = header.toString();
            if (headerText === 'TARIFA de Modulo') {
                headerText = 'TARIFA';
            }
            
            const textWidth = doc.getTextWidth(headerText);
            const centerX = currentX + (width / 2) - (textWidth / 2);
            
            doc.text(headerText, centerX, y + 8);
            
            currentX += width;
        });
    }

    /**
     * NUEVA FUNCIÓN: Dividir texto para que quepa en el ancho especificado
     */
    splitTextToFitWidth(doc, text, maxWidth) {
        if (!text || text === 'N/A') return [text];
        
        const words = text.toString().split(' ');
        const lines = [];
        let currentLine = '';
        
        for (let word of words) {
            const testLine = currentLine ? `${currentLine} ${word}` : word;
            const testWidth = doc.getTextWidth(testLine);
            
            if (testWidth <= maxWidth) {
                currentLine = testLine;
            } else {
                if (currentLine) {
                    lines.push(currentLine);
                    currentLine = word;
                } else {
                    // Palabra muy larga, dividir por caracteres
                    lines.push(...this.splitLongWord(doc, word, maxWidth));
                    currentLine = '';
                }
            }
        }
        
        if (currentLine) {
            lines.push(currentLine);
        }
        
        return lines.length > 0 ? lines : [text];
    }

    /**
     * Dibujar fila de datos (con bordes sutiles y consistentes con headers)
     */
    drawDataRow(doc, rowData, headers, columnWidths, y, rowIndex, reportType) {
        let currentX = PDF_CONFIG.margin;
        const baseRowHeight = 14; // Altura base de fila (mínima)
        
        // Calcular la altura real necesaria para esta fila
        let maxTextHeight = baseRowHeight;
        const cellTexts = [];
        
        // Pre-procesar todos los textos para calcular altura necesaria
        headers.forEach((header, index) => {
            const width = columnWidths[index];
            let cellValue = this.getCellValue(rowData, header, reportType);
            
            // Verificar si el texto necesita ser dividido
            const lines = this.splitTextToFitWidth(doc, cellValue.toString(), width - 8); // 8mm de padding
            cellTexts[index] = lines;
            
            // Calcular altura necesaria
            const textHeight = lines.length * 4; // 4mm por línea
            if (textHeight > maxTextHeight) {
                maxTextHeight = textHeight;
            }
        });
        
        // Asegurar altura mínima
        const finalRowHeight = Math.max(maxTextHeight, baseRowHeight);
        
        // Fondo alternado
        if (rowIndex % 2 === 0) {
            doc.setFillColor(ARVIC_COLORS.lightGray);
            doc.rect(PDF_CONFIG.margin, y, columnWidths.reduce((a, b) => a + b, 0), finalRowHeight, 'F');
        }
        
        // Dibujar celdas y textos
        headers.forEach((header, index) => {
            const width = columnWidths[index];
            const lines = cellTexts[index];
            
            // Dibujar bordes de celda
            doc.setLineWidth(0.2);
            doc.setDrawColor(200, 200, 200);
            doc.rect(currentX, y, width, finalRowHeight);
            
            // Configurar texto
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(PDF_CONFIG.dataFontSize);
            doc.setTextColor(ARVIC_COLORS.black);
            
            // Determinar alineación
            const alignment = this.getCellAlignment(header);
            
            // Dibujar cada línea de texto
            lines.forEach((line, lineIndex) => {
                let textX = currentX + 4; // Margen izquierdo por defecto
                
                if (alignment === 'center') {
                    textX = currentX + (width / 2);
                } else if (alignment === 'right') {
                    textX = currentX + width - 4;
                }
                
                const textY = y + 8 + (lineIndex * 4); // Espaciado entre líneas
                doc.text(line, textX, textY, { align: alignment });
            });
            
            currentX += width;
        });
        
        return finalRowHeight; // Retornar la altura real usada
    }

    /**
     * NUEVA FUNCIÓN: Dividir palabras muy largas por caracteres
     */
    splitLongWord(doc, word, maxWidth) {
        const lines = [];
        let currentPart = '';
        
        for (let char of word) {
            const testPart = currentPart + char;
            const testWidth = doc.getTextWidth(testPart);
            
            if (testWidth <= maxWidth) {
                currentPart = testPart;
            } else {
                if (currentPart) {
                    lines.push(currentPart);
                }
                currentPart = char;
            }
        }
        
        if (currentPart) {
            lines.push(currentPart);
        }
        
        return lines;
    }

    /**
     * Obtener valor de celda con mapeo correcto según el tipo de reporte
     */
    getCellValue(rowData, header, reportType) {
        console.log(`🔍 getCellValue - Header: "${header}", ReportType: "${reportType}"`);
        
        // 🔧 MANEJO ESPECIAL PARA REPORTE REMANENTE
        if (reportType === 'remanente') {
            console.log('📊 Procesando celda de reporte remanente:', header);
            
            if (header === 'Total de Horas') {
                const totalHoras = rowData.totalHoras || 0;
                return `${parseFloat(totalHoras).toFixed(1)} hrs`;
            }
            
            // Para subcolomnas de semana (MODULO, TIEMPO, TARIFA, TOTAL)
            if (header === 'MODULO') {
                // Determinar qué semana basándose en la posición en headers
                // Esto se maneja de forma diferente - ver drawDataRow corregida
                return header; // Placeholder, se maneja en drawDataRow
            }
            
            if (header === 'TIEMPO') {
                return header; // Placeholder, se maneja en drawDataRow
            }
            
            if (header === 'TARIFA') {
                return header; // Placeholder, se maneja en drawDataRow
            }
            
            if (header === 'TOTAL') {
                return header; // Placeholder, se maneja en drawDataRow
            }
            
            return rowData[header] || '';
        }
        
        // 📋 MANEJO NORMAL PARA OTROS REPORTES
        switch (header) {
            case 'ID Empresa':
                return rowData.idEmpresa || rowData.empresaId || 'N/A';
            case 'Consultor':
                return rowData.consultor || rowData.consultorName || 'N/A';
            case 'Soporte':
                return rowData.soporte || rowData.soporteName || rowData.supportName || 'N/A';
            case 'Modulo':
                return rowData.modulo || rowData.moduloName || rowData.moduleName || 'N/A';
            case 'TIEMPO':
                const tiempo = rowData.editedTime || rowData.tiempo || rowData.hours || 0;
                return `${parseFloat(tiempo).toFixed(1)} hrs`;
            case 'TARIFA de Modulo':
                const tarifa = rowData.editedTariff || rowData.tarifa || rowData.rate || 0;
                return `$${parseFloat(tarifa).toLocaleString('es-MX')}`;
            case 'TOTAL':
                const total = rowData.editedTotal || rowData.total || 0;
                return `$${parseFloat(total).toLocaleString('es-MX', { minimumFractionDigits: 2 })}`;
            default:
                return rowData[header] || rowData[header.toLowerCase()] || '';
        }
    }

    /**
     * Determinar alineación de celda (actualizado para nuevo header)
     */
    getCellAlignment(header) {
        const rightAligned = ['TIEMPO', 'TARIFA de Modulo', 'TARIFA', 'TOTAL'];
        const centerAligned = ['ID Empresa'];
        
        if (rightAligned.includes(header)) return 'right';
        if (centerAligned.includes(header)) return 'center';
        return 'left';
    }

    /**
     * Añadir footer (replicando diseño exacto del objetivo)
     */
    addFooter(doc) {
        const pageHeight = doc.internal.pageSize.getHeight();
        const pageWidth = doc.internal.pageSize.getWidth();
        const footerY = pageHeight - 25;
        
        // Línea separadora azul (más gruesa como en el objetivo)
        doc.setDrawColor(ARVIC_COLORS.primary);
        doc.setLineWidth(1.2); // Aumentado de 0.8 a 1.2 para que coincida con el objetivo
        doc.line(PDF_CONFIG.margin, footerY - 10, pageWidth - PDF_CONFIG.margin, footerY - 10);
        
        // Texto del footer (arriba de la línea)
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(8);
        doc.setTextColor(ARVIC_COLORS.textGray);
        
        // Lado izquierdo - Sistema
        doc.text('GRUPO IT ARVIC - Sistema de Gestión Empresarial', PDF_CONFIG.margin, footerY - 3);
        
        // Lado derecho - Documento generado automáticamente
        const currentDate = new Date().toLocaleDateString('es-MX', {
            day: '2-digit',
            month: '2-digit',
            year: 'numeric'
        });
        const currentTime = new Date().toLocaleTimeString('es-MX', {
            hour: '2-digit',
            minute: '2-digit',
            hour12: true
        });
        doc.text(`Documento generado automáticamente - ${currentDate}, ${currentTime}`, 
                 pageWidth - PDF_CONFIG.margin, footerY - 3, { align: 'right' });
        
        // Número de página (CENTRADO y DEBAJO de la línea azul)
        const pageNumber = doc.internal.getCurrentPageInfo().pageNumber;
        doc.text(`Página ${pageNumber}`, pageWidth / 2, footerY + 3, { align: 'center' }); // Ajustado posición
    }

    /**
     * Generar nombre de archivo
     */
    generateFileName(reportType, metadata) {
        const date = new Date();
        const dateStr = date.toISOString().split('T')[0];
        const timeStr = date.toTimeString().split(' ')[0].replace(/:/g, '');
        
        const reportNames = {
            'pago-consultor-general': 'ReportePagoGeneral',
            'pago-consultor-especifico': 'ReportePagoConsultor',
            'cliente-soporte': 'ReporteSoporteCliente',
            'remanente': 'ReporteRemanente',
            'proyecto-general': 'ReporteProyectoGeneral',
            'proyecto-cliente': 'ReporteProyectoCliente',
            'proyecto-consultor': 'ReporteProyectoConsultor'
        };
        
        const baseName = reportNames[reportType] || 'ReporteARVIC';
        return `${baseName}_${dateStr}_${timeStr}.pdf`;
    }

    /**
     * FUNCIÓN NUEVA: Transformar datos de remanente para estructura de PDF
     * Convierte la estructura anidada en estructura plana como la vista previa
     */
    transformRemanenteDataForPDF(editableData) {
        console.log('🔄 Transformando datos separando soportes y proyectos...');
        
        if (!editableData || Object.keys(editableData).length === 0) {
            return { soportes: [], proyectos: [] };
        }
        
        const soporteData = [];
        const proyectoData = [];
        
        Object.values(editableData).forEach((row, index) => {
            if (!row || typeof row !== 'object') return;
            
            // Filtrar fila de totales
            if (row['posicion_0'] === 'TOTALES') return;
            
            console.log(`Fila ${index}: type="${row.type}", projectName="${row.projectName}"`);

            // ✅ SEPARAR POR TIPO
            if (row.type === 'project') {
                console.log(`✅ Procesando proyecto en transformación:`, {
                    projectName: row.projectName,
                    moduleName: row.moduleName,
                    totalHours: row.totalHours,
                    tarifa: row.editedTariff,
                    total: row.editedTotal,
                    todasLasKeys: Object.keys(row)
                });

                // Es un proyecto - solo tiene totales
                proyectoData.push({
                    projectName: row.projectName || 'Proyecto Sin Nombre',
                    moduleName: row.moduleName || 'Módulo Sin Nombre',
                    totalHours: parseFloat(row.totalHours || row.editedTime || 0),
                    tarifa: parseFloat(row.editedTariff || row.tarifa || 0),        
                    total: parseFloat(row.editedTotal || row.total || 0)            
                });
            } else {
                // Es un soporte - tiene estructura de semanas
                const flatRow = {
                    totalHoras: parseFloat(row['posicion_0'] || row.totalHoras || 0)
                };
                
                // Mapear semanas (solo para soportes)
                for (let semana = 1; semana <= 5; semana++) {
                    const baseIndex = (semana - 1) * 4 + 1;
                    
                    const modulo = row[`posicion_${baseIndex}`] || '-';
                    const tiempo = row[`posicion_${baseIndex + 1}`] || '0.0';
                    const tarifa = row[`posicion_${baseIndex + 2}`] || '$0';
                    const total = row[`posicion_${baseIndex + 3}`] || '$0.00';
                    
                    flatRow[`modulo${semana}`] = modulo;
                    flatRow[`tiempo${semana}`] = tiempo === '' ? '0.0' : tiempo;
                    flatRow[`tarifa${semana}`] = tarifa === '' ? '$0' : tarifa;
                    flatRow[`total${semana}`] = total;
                }
                
                soporteData.push(flatRow);
            }
        });
        
        console.log(`✅ Transformación completa:`, {
            soportes: soporteData.length,
            proyectos: proyectoData.length
        });
        
        return {
            soportes: soporteData,
            proyectos: proyectoData
        };
    }

    /**
     * FUNCIÓN NUEVA: drawDataRow especializada para remanente
     */
    drawRemanenteDataRow(doc, rowData, headers, columnWidths, y, rowIndex) {
        let currentX = PDF_CONFIG.margin;
        const rowHeight = 18; // Altura fija más generosa para remanente
        
        // Fondo alternado
        if (rowIndex % 2 === 0) {
            doc.setFillColor(ARVIC_COLORS.lightGray);
            doc.rect(PDF_CONFIG.margin, y, columnWidths.reduce((a, b) => a + b, 0), rowHeight, 'F');
        }
        
        // Configurar texto
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(8); // Fuente más pequeña para más datos
        doc.setTextColor(ARVIC_COLORS.black);
        
        let headerIndex = 0;
        
        // Primera columna: Total de Horas
        const totalHoras = parseFloat(rowData.totalHoras || 0).toFixed(1);
        
        doc.setLineWidth(0.2);
        doc.setDrawColor(200, 200, 200);
        doc.rect(currentX, y, columnWidths[0], rowHeight);
        
        doc.setFont('helvetica', 'bold');
        doc.text(`${totalHoras} hrs`, currentX + columnWidths[0]/2, y + rowHeight/2 + 2, { align: 'center' });
        
        currentX += columnWidths[0];
        headerIndex++;
        
        // Detectar número de semanas
        const remainingHeaders = headers.length - 1;
        const numberOfWeeks = remainingHeaders / 4;
        
        // Dibujar datos para cada semana
        for (let semana = 1; semana <= numberOfWeeks; semana++) {
            doc.setFont('helvetica', 'normal');
            
            // MODULO
            const modulo = rowData[`modulo${semana}`] || '-';
            doc.rect(currentX, y, columnWidths[headerIndex], rowHeight);
            doc.text(modulo, currentX + 2, y + rowHeight/2 + 2);
            currentX += columnWidths[headerIndex];
            headerIndex++;
            
            // TIEMPO
            const tiempo = parseFloat(rowData[`tiempo${semana}`] || 0).toFixed(1);
            doc.rect(currentX, y, columnWidths[headerIndex], rowHeight);
            doc.text(`${tiempo} hrs`, currentX + columnWidths[headerIndex]/2, y + rowHeight/2 + 2, { align: 'center' });
            currentX += columnWidths[headerIndex];
            headerIndex++;
            
            // TARIFA
            const tarifa = parseFloat(rowData[`tarifa${semana}`] || 0);
            doc.rect(currentX, y, columnWidths[headerIndex], rowHeight);
            doc.text(`$${tarifa.toLocaleString('es-MX')}`, currentX + columnWidths[headerIndex]/2, y + rowHeight/2 + 2, { align: 'center' });
            currentX += columnWidths[headerIndex];
            headerIndex++;
            
            // TOTAL
            const total = parseFloat(rowData[`total${semana}`] || 0);
            doc.rect(currentX, y, columnWidths[headerIndex], rowHeight);
            doc.setFont('helvetica', 'bold');
            doc.text(`$${total.toLocaleString('es-MX')}`, currentX + columnWidths[headerIndex]/2, y + rowHeight/2 + 2, { align: 'center' });
            doc.setFont('helvetica', 'normal');
            currentX += columnWidths[headerIndex];
            headerIndex++;
        }
        
        return rowHeight;
    }

    /**
     * NUEVA FUNCIÓN: Generar reporte remanente en múltiples páginas
     * Página 1: Total + Semanas 1-2
     * Página 2: Total + Semanas 3-4  
     * Página 3: Total + Semana 5 + Totales
     */
    generateRemanenteMultiPageReport(doc, soporteData, config, startY, proyectoData = []) {
        console.log('📄 Generando reporte en 3 páginas...');
        console.log('🔍 DEBUG - generateRemanenteMultiPageReport iniciado');
        console.log('📊 Soportes recibidos:', soporteData.length);
        console.log('📁 Proyectos recibidos:', proyectoData.length);
        console.log('📁 Datos de proyectos:', proyectoData);
        
        const pageWidth = doc.internal.pageSize.getWidth();
        const tableWidth = pageWidth - (PDF_CONFIG.margin * 2);
        const bottomMargin = 50;
        
        // Definición de páginas
        const pages = [
            { pageNum: 1, weeks: [1, 2], title: 'Semanas 1-2' },
            { pageNum: 2, weeks: [3, 4], title: 'Semanas 3-4' },
            { pageNum: 3, weeks: [5], title: 'Semana 5' }
        ];
        
        // Generar cada página
        pages.forEach((pageConfig, pageIndex) => {
            if (pageIndex > 0) {
                doc.addPage();
                this.addCompleteHeader(doc, config, config.metadata || {});
            }
            
            console.log(`📄 Generando página ${pageConfig.pageNum}: ${pageConfig.title}`);
            
            // Calcular anchos de columna para esta página
            const numWeeks = pageConfig.weeks.length;
            const columnWidths = this.calculateRemanenteColumnWidths(tableWidth, numWeeks);
            
            // Generar estructura de headers
            const headerStructure = {
                totalWeeks: numWeeks,
                weeks: pageConfig.weeks,
                pageNum: pageConfig.pageNum,
                totalPages: pages.length
            };
            
            // Dibujar headers
            const headerHeight = this.drawRemanenteHeadersMultiPage(
                doc, 
                headerStructure, 
                columnWidths, 
                startY
            );
            
            // Dibujar filas de datos
            let currentY = startY + headerHeight + 2;

            soporteData.forEach((row, rowIndex) => {
                // Verificar si necesitamos nueva página (solo si hay muchas filas)
                if (currentY + 18 > doc.internal.pageSize.getHeight() - bottomMargin) {
                    this.addFooter(doc);
                    doc.addPage();
                    this.addCompleteHeader(doc, config, config.metadata || {});
                    currentY = startY;
                    
                    // Re-dibujar headers
                    this.drawRemanenteHeadersMultiPage(
                        doc, 
                        headerStructure, 
                        columnWidths, 
                        currentY
                    );
                    currentY += headerHeight + 2;
                }
                
                // Dibujar fila con solo las semanas de esta página
                this.drawRemanenteDataRowMultiPage(
                    doc, 
                    row, 
                    pageConfig.weeks, 
                    columnWidths, 
                    currentY, 
                    rowIndex
                );
                
                currentY += 15;
            });
            
            // Si es la última página, agregar totales
            if (pageConfig.pageNum === pages.length) {
                currentY += 10;
                
                if (currentY + 40 > doc.internal.pageSize.getHeight() - bottomMargin) {
                    this.addFooter(doc);
                    doc.addPage();
                    currentY = 30;
                }
            }
            
            // Agregar footer con número de página
            this.addFooterWithPageNumber(doc, pageConfig.pageNum, pages.length);

            // Si es la última página, agregar totales Y proyectos
            if (pageConfig.pageNum === pages.length) {
                console.log('✅ Última página detectada');
                currentY += 10;
                
                if (currentY + 40 > doc.internal.pageSize.getHeight() - bottomMargin) {
                    this.addFooter(doc);
                    doc.addPage();
                    currentY = 30;
                }
                
                this.addRemanenteTotals(doc, soporteData, pageWidth, currentY);
                console.log('✅ Totales de soportes dibujados');
                
                // Verificar proyectos
                console.log('🔍 Verificando proyectos...');
                console.log('proyectoData:', proyectoData);
                console.log('proyectoData existe?', !!proyectoData);
                console.log('proyectoData.length:', proyectoData?.length);
                
                if (proyectoData && proyectoData.length > 0) {
                    console.log('✅ ENTRANDO a dibujar sección de proyectos');
                    currentY += 50;
                    
                    if (currentY + 60 > doc.internal.pageSize.getHeight() - bottomMargin) {
                        this.addFooter(doc);
                        doc.addPage();
                        this.addCompleteHeader(doc, config, config.metadata || {});
                        currentY = startY;
                    }
                    
                    this.drawProyectosSection(doc, proyectoData, pageWidth, currentY);
                    console.log('✅ Sección de proyectos dibujada');
                } else {
                    console.log('❌ NO se dibuja sección de proyectos porque:');
                    console.log('   - proyectoData es null/undefined?', !proyectoData);
                    console.log('   - proyectoData está vacío?', proyectoData?.length === 0);
                }
            }
        });
    }

    /**
     * Calcular anchos de columna para remanente según número de semanas
     */
    calculateRemanenteColumnWidths(tableWidth, numWeeks) {
        const totalColumnWidth = tableWidth * 0.18; // 18% para Total de Horas
        const weekAreaWidth = tableWidth * 0.82;    // 82% para las semanas
        const weekColumnWidth = weekAreaWidth / numWeeks;
        const subColumnWidth = weekColumnWidth / 4; // 4 subcolomnas por semana
        
        const widths = [totalColumnWidth];
        
        // Agregar anchos para cada semana (4 subcolomnas por semana)
        for (let i = 0; i < numWeeks; i++) {
            widths.push(subColumnWidth, subColumnWidth, subColumnWidth, subColumnWidth);
        }
        
        console.log(`📏 Anchos calculados para ${numWeeks} semanas:`, widths);
        return widths;
    }

    /**
     * Dibujar headers jerárquicos para páginas específicas
     */
    drawRemanenteHeadersMultiPage(doc, headerStructure, columnWidths, y) {
        let currentX = PDF_CONFIG.margin;
        const mainHeaderHeight = 12;
        const subHeaderHeight = 10;
        
        const totalColumnWidth = columnWidths[0];
        const remainingWidth = columnWidths.slice(1).reduce((a, b) => a + b, 0);
        const weekColumnWidth = remainingWidth / headerStructure.totalWeeks;
        
        // Configurar fuente
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(10);
        doc.setTextColor(255, 255, 255);
        
        // Columna "Total de Horas"
        doc.setFillColor(25, 118, 210);
        doc.rect(currentX, y, totalColumnWidth, mainHeaderHeight + subHeaderHeight, 'F');
        doc.rect(currentX, y, totalColumnWidth, mainHeaderHeight + subHeaderHeight);
        doc.text('Total de Horas', currentX + totalColumnWidth/2, y + (mainHeaderHeight + subHeaderHeight)/2 + 3, { align: 'center' });
        currentX += totalColumnWidth;
        
        // Headers de semanas (solo las de esta página)
        headerStructure.weeks.forEach(weekNum => {
            doc.setFillColor(25, 118, 210);
            doc.rect(currentX, y, weekColumnWidth, mainHeaderHeight, 'F');
            doc.rect(currentX, y, weekColumnWidth, mainHeaderHeight);
            doc.text(`Semana ${weekNum}`, currentX + weekColumnWidth/2, y + mainHeaderHeight/2 + 3, { align: 'center' });
            
            const subColumnWidth = weekColumnWidth / 4;
            let subX = currentX;
            
            ['MODULO', 'TIEMPO', 'TARIFA', 'TOTAL'].forEach(subHeader => {
                doc.setFillColor(33, 150, 243);
                doc.rect(subX, y + mainHeaderHeight, subColumnWidth, subHeaderHeight, 'F');
                doc.rect(subX, y + mainHeaderHeight, subColumnWidth, subHeaderHeight);
                
                doc.setFontSize(8);
                doc.text(subHeader, subX + subColumnWidth/2, y + mainHeaderHeight + subHeaderHeight/2 + 2, { align: 'center' });
                
                subX += subColumnWidth;
            });
            
            currentX += weekColumnWidth;
        });
        
        return mainHeaderHeight + subHeaderHeight;
    }

    /**
     * Dibujar fila de datos con solo las semanas especificadas
     */
    drawRemanenteDataRowMultiPage(doc, rowData, weeks, columnWidths, y, rowIndex) {
        let currentX = PDF_CONFIG.margin;
        const rowHeight = 15;
        
        // Fondo alternado
        if (rowIndex % 2 === 0) {
            doc.setFillColor(ARVIC_COLORS.lightGray);
            doc.rect(PDF_CONFIG.margin, y, columnWidths.reduce((a, b) => a + b, 0), rowHeight, 'F');
        }
        
        // Configurar texto
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(9);
        doc.setTextColor(ARVIC_COLORS.black);
        doc.setLineWidth(0.2);
        doc.setDrawColor(200, 200, 200);
        
        let columnIndex = 0;
        
        // Columna 1: Total de Horas
        const totalHoras = parseFloat(rowData.totalHoras || 0).toFixed(1);
        doc.rect(currentX, y, columnWidths[columnIndex], rowHeight);
        doc.setFont('helvetica', 'bold');
        doc.text(`${totalHoras} hrs`, currentX + columnWidths[columnIndex]/2, y + rowHeight/2 + 2, { align: 'center' });
        doc.setFont('helvetica', 'normal');
        currentX += columnWidths[columnIndex++];
        
        // Datos de las semanas especificadas
        weeks.forEach(semana => {
            // MODULO
            const modulo = rowData[`modulo${semana}`] || '-';
            doc.rect(currentX, y, columnWidths[columnIndex], rowHeight);
            doc.setFontSize(8);
            doc.text(modulo, currentX + columnWidths[columnIndex]/2, y + rowHeight/2 + 2, { align: 'center' });
            doc.setFontSize(9);
            currentX += columnWidths[columnIndex++];
            
            // TIEMPO
            const tiempo = rowData[`tiempo${semana}`] || '0.0';
            doc.rect(currentX, y, columnWidths[columnIndex], rowHeight);
            doc.text(tiempo === '0.0' ? '-' : `${tiempo}h`, currentX + columnWidths[columnIndex]/2, y + rowHeight/2 + 2, { align: 'center' });
            currentX += columnWidths[columnIndex++];
            
            // TARIFA
            const tarifa = rowData[`tarifa${semana}`] || '$0';
            doc.rect(currentX, y, columnWidths[columnIndex], rowHeight);
            doc.text(tarifa === '$0' ? '-' : tarifa, currentX + columnWidths[columnIndex]/2, y + rowHeight/2 + 2, { align: 'center' });
            currentX += columnWidths[columnIndex++];
            
            // TOTAL
            const total = rowData[`total${semana}`] || '$0.00';
            doc.rect(currentX, y, columnWidths[columnIndex], rowHeight);
            doc.setFont('helvetica', 'bold');
            doc.setTextColor(0, 100, 0);
            doc.text(total, currentX + columnWidths[columnIndex]/2, y + rowHeight/2 + 2, { align: 'center' });
            doc.setTextColor(0, 0, 0);
            doc.setFont('helvetica', 'normal');
            currentX += columnWidths[columnIndex++];
        });
        
        return rowHeight;
    }

    /**
     * Agregar totales consolidados al final del reporte
     */
    addRemanenteTotals(doc, data, pageWidth, y) {
        console.log('📊 Calculando totales consolidados...');
        
        let totalHoras = 0;
        let totalMonto = 0;
        
        data.forEach(row => {
            totalHoras += parseFloat(row.totalHoras || 0);
            
            // Sumar totales de todas las semanas
            for (let semana = 1; semana <= 5; semana++) {
                const total = row[`total${semana}`] || '$0.00';
                const numericTotal = parseFloat(total.replace(/[$,]/g, ''));
                totalMonto += numericTotal;
            }
        });
        
        // Dibujar sección de totales
        doc.setDrawColor(25, 118, 210);
        doc.setLineWidth(0.5);
        doc.line(PDF_CONFIG.margin, y, pageWidth - PDF_CONFIG.margin, y);
        
        y += 8;
        
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(13);
        doc.setTextColor(ARVIC_COLORS.primary);
        
        doc.text(`Total Horas: ${totalHoras.toFixed(1)} hrs`, 
                pageWidth - PDF_CONFIG.margin, y, { align: 'right' });
        
        doc.text(`Total Monto: $${totalMonto.toLocaleString('es-MX', { minimumFractionDigits: 2 })}`, 
                pageWidth - PDF_CONFIG.margin, y + 10, { align: 'right' });
        
        console.log(`✅ Totales: ${totalHoras.toFixed(1)} hrs, $${totalMonto.toFixed(2)}`);
    }

    /**
     * Agregar footer con número de página
     */
    addFooterWithPageNumber(doc, currentPage, totalPages) {
        const pageHeight = doc.internal.pageSize.getHeight();
        const pageWidth = doc.internal.pageSize.getWidth();
        const footerY = pageHeight - 15;
        
        // Línea divisoria
        doc.setDrawColor(25, 118, 210);
        doc.setLineWidth(0.5);
        doc.line(PDF_CONFIG.margin, footerY - 5, pageWidth - PDF_CONFIG.margin, footerY - 5);
        
        // Texto del footer
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(9);
        doc.setTextColor(100, 100, 100);
        
        doc.text('GRUPO IT ARVIC - Sistema de Gestión Empresarial', 
                PDF_CONFIG.margin, footerY);
        
        const currentDate = new Date().toLocaleDateString('es-MX', {
            year: 'numeric',
            month: 'long',
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        });
        
        doc.text(`Documento generado automáticamente - ${currentDate}`, 
                PDF_CONFIG.margin, footerY + 6);
        
        // Número de página
        doc.setFont('helvetica', 'bold');
        doc.text(`Página ${currentPage} de ${totalPages}`, 
                pageWidth - PDF_CONFIG.margin, footerY, { align: 'right' });
    }

    /**
     * NUEVA FUNCIÓN: Dibujar sección de proyectos en el PDF
     */
    drawProyectosSection(doc, proyectoData, pageWidth, startY) {    
        console.log('🎨 EJECUTANDO drawProyectosSection');
        console.log('📁 proyectoData recibido:', proyectoData);
        console.log('📏 pageWidth:', pageWidth);
        console.log('📍 startY:', startY);

        proyectoData.forEach((proyecto, i) => {
            console.log(`Proyecto ${i}:`, {
                projectName: proyecto.projectName,
                moduleName: proyecto.moduleName,
                totalHours: proyecto.totalHours,
                tarifa: proyecto.tarifa,
                total: proyecto.total
            });
        });
        
        if (!proyectoData || proyectoData.length === 0) {
            console.error('❌ proyectoData está vacío en drawProyectosSection');
            return;
        }

        console.log('📁 Dibujando sección de proyectos:', proyectoData.length);
        
        let currentY = startY;
        const margin = PDF_CONFIG.margin;
        const tableWidth = pageWidth - (margin * 2);
        
        // Título de sección
        doc.setFillColor(25, 118, 210);
        doc.rect(margin, currentY, tableWidth, 10, 'F');
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(12);
        doc.setTextColor(255, 255, 255);
        doc.text('PROYECTOS DEL CLIENTE', margin + 5, currentY + 7);
        currentY += 12;
        
        // Headers de tabla de proyectos
        const colWidths = [
            tableWidth * 0.30,  // Proyecto
            tableWidth * 0.30,  // Módulo
            tableWidth * 0.15,  // Total Horas
            tableWidth * 0.10,  // Tarifa
            tableWidth * 0.15   // Total
        ];
        
        doc.setFillColor(33, 150, 243);
        let currentX = margin;
        
        const headers = ['Proyecto', 'Módulo', 'Total Horas', 'Tarifa', 'Total'];
        headers.forEach((header, index) => {
            // 1. Dibujar fondo azul
            doc.setFillColor(33, 150, 243);
            doc.rect(currentX, currentY, colWidths[index], 10, 'F');
            
            // 2. Dibujar borde
            doc.setDrawColor(33, 150, 243);
            doc.setLineWidth(0.5);
            doc.rect(currentX, currentY, colWidths[index], 10);
            
            // 3. Configurar texto DENTRO del loop (no antes)
            doc.setFont('helvetica', 'bold');
            doc.setFontSize(9);
            doc.setTextColor(255, 255, 255);  // Blanco
            
            // 4. Dibujar texto
            const textX = currentX + colWidths[index]/2;
            const textY = currentY + 7;
            doc.text(header, textX, textY, { align: 'center' });
            
            console.log(`Header "${header}" dibujado en (${textX}, ${textY})`);
            
            currentX += colWidths[index];
        });

        // 5. CRÍTICO: Resetear colores antes de continuar
        doc.setTextColor(0, 0, 0);  // Negro para datos
        doc.setDrawColor(200, 200, 200);  // Gris para bordes de datos
        doc.setLineWidth(0.2);

        currentY += 10;
        
        // Agrupar por proyecto
        const projectGroups = {};
        proyectoData.forEach(row => {
            const projectKey = row.projectName;
            if (!projectGroups[projectKey]) {
                projectGroups[projectKey] = [];
            }
            projectGroups[projectKey].push(row);
        });
        
        // Dibujar datos por proyecto
        doc.setTextColor(0, 0, 0);
        doc.setFont('helvetica', 'normal');
        doc.setFontSize(9);
        
        let totalProjectHours = 0;
        let totalProjectAmount = 0;
        
        Object.entries(projectGroups).forEach(([projectName, modules]) => {
            modules.forEach((row, index) => {
                // Fondo alternado
                if (index % 2 === 0) {
                    doc.setFillColor(245, 245, 245);
                    doc.rect(margin, currentY, tableWidth, 8, 'F');
                }
                
                currentX = margin;
                
                // Proyecto (solo en primera fila del grupo)
                doc.setFont('helvetica', index === 0 ? 'bold' : 'normal');
                doc.rect(currentX, currentY, colWidths[0], 8);
                if (index === 0) {
                    doc.text(projectName, currentX + 2, currentY + 5.5);
                }
                currentX += colWidths[0];
                
                // Módulo
                doc.setFont('helvetica', 'normal');
                doc.rect(currentX, currentY, colWidths[1], 8);
                doc.text(row.moduleName, currentX + 2, currentY + 5.5);
                currentX += colWidths[1];

                // Total Horas
                doc.rect(currentX, currentY, colWidths[2], 8);
                doc.text(`${row.totalHours.toFixed(1)} hrs`, currentX + colWidths[2]/2, currentY + 5.5, { align: 'center' });
                currentX += colWidths[2];

                // Tarifa
                doc.rect(currentX, currentY, colWidths[3], 8);
                doc.text(`$${row.tarifa.toLocaleString('es-MX')}`, currentX + colWidths[3]/2, currentY + 5.5, { align: 'center' });
                currentX += colWidths[3];

                // Total
                doc.rect(currentX, currentY, colWidths[4], 8);
                doc.setFont('helvetica', 'bold');
                doc.setTextColor(0, 100, 0);
                doc.text(`$${row.total.toLocaleString('es-MX', { minimumFractionDigits: 2 })}`, currentX + colWidths[4]/2, currentY + 5.5, { align: 'center' });
                doc.setTextColor(0, 0, 0);
                doc.setFont('helvetica', 'normal');
                
                totalProjectHours += row.totalHours;
                totalProjectAmount += row.total;
                
                currentY += 8;
            });
        });
        
        // Totales de proyectos
        currentY += 2;
        doc.setFillColor(220, 220, 220);
        doc.rect(margin, currentY, tableWidth, 10, 'F');
        doc.rect(margin, currentY, tableWidth, 10);
        
        doc.setFont('helvetica', 'bold');
        doc.setFontSize(10);
        doc.setTextColor(0, 0, 0);
        
        currentX = margin;
        doc.text('TOTAL PROYECTOS', currentX + 5, currentY + 7);
        currentX += colWidths[0] + colWidths[1];
        doc.text(`${totalProjectHours.toFixed(1)} hrs`, currentX + colWidths[2]/2, currentY + 7, { align: 'center' });
        currentX += colWidths[2] + colWidths[3];
        doc.text(`$${totalProjectAmount.toLocaleString('es-MX', { minimumFractionDigits: 2 })}`, currentX + colWidths[4]/2, currentY + 7, { align: 'center' });
        
        console.log(`✅ Sección de proyectos dibujada: ${proyectoData.length} módulos, $${totalProjectAmount.toFixed(2)}`);
    }
}

/**
 * FUNCIONES NUEVAS PARA REMANENTE
 */

// Función 1: Extraer datos editables correctos
/**
 * Extraer datos editables correctos PRESERVANDO proyectos
 */
function extraerDatosEditablesCorrectos() {
    console.log('🔧 Extrayendo datos con input.value (preservando proyectos)...');
    
    const tabla = document.querySelector('#reportPreviewPanel table');
    if (!tabla) return null;
    
    // 1. GUARDAR proyectos existentes antes de sobrescribir
    const proyectosExistentes = [];
    if (editablePreviewData) {
        Object.values(editablePreviewData).forEach(row => {
            if (row.type === 'project') {
                proyectosExistentes.push(row);
            }
        });
    }
    
    console.log(`💾 Proyectos guardados antes de extraer: ${proyectosExistentes.length}`);
    console.log('📁 Proyectos encontrados:', proyectosExistentes);
    
    // 2. EXTRAER datos de la tabla (solo soportes visibles)
    const filas = Array.from(tabla.querySelectorAll('tbody tr'));
    const datosCorrectos = {};
    
    filas.forEach((fila, filaIndex) => {
        const celdas = Array.from(fila.querySelectorAll('td'));
        const objeto = {};
        
        celdas.forEach((celda, celdaIndex) => {
            const input = celda.querySelector('input');
            let valor = input ? input.value : celda.textContent.trim();
            objeto[`posicion_${celdaIndex}`] = valor;
        });
        
        datosCorrectos[filaIndex] = objeto;
    });
    
    // 3. RE-AGREGAR proyectos al final
    let siguienteIndice = Object.keys(datosCorrectos).length;
    proyectosExistentes.forEach(proyecto => {
        datosCorrectos[siguienteIndice] = proyecto;
        siguienteIndice++;
    });
    
    console.log(`✅ Datos finales: ${Object.keys(datosCorrectos).length} filas (${proyectosExistentes.length} proyectos preservados)`);
    
    window.editablePreviewData = datosCorrectos;
    return datosCorrectos;
}

// Función 2: Generar headers jerárquicos
ARVICPDFExporter.prototype.generateRemanenteHeaders = function(editableData) {
    console.log('📋 Generando headers jerárquicos para 5 semanas...');
    
    const headerStructure = {
        totalWeeks: 5,
        mainHeaders: ['Total de Horas'],
        subHeaders: ['Total de Horas']
    };
    
    for (let semana = 1; semana <= 5; semana++) {
        headerStructure.mainHeaders.push(`Semana ${semana}`);
        headerStructure.subHeaders.push('MODULO', 'TIEMPO', 'TARIFA', 'TOTAL');
    }
    
    return headerStructure;
};

// Función 3: Dibujar headers jerárquicos
ARVICPDFExporter.prototype.drawRemanenteHeaders = function(doc, headerStructure, columnWidths, y) {
    let currentX = 20;
    const mainHeaderHeight = 12;
    const subHeaderHeight = 10;
    
    const totalColumnWidth = columnWidths[0];
    const remainingWidth = columnWidths.slice(1).reduce((a, b) => a + b, 0);
    const weekColumnWidth = remainingWidth / headerStructure.totalWeeks;
    
    // Headers principales
    doc.setFillColor(25, 118, 210);
    doc.setFont('helvetica', 'bold');
    doc.setFontSize(10);
    doc.setTextColor(255, 255, 255);
    
    // Total de Horas
    doc.rect(currentX, y, totalColumnWidth, mainHeaderHeight + subHeaderHeight, 'F');
    doc.rect(currentX, y, totalColumnWidth, mainHeaderHeight + subHeaderHeight);
    doc.text('Total de Horas', currentX + totalColumnWidth/2, y + (mainHeaderHeight + subHeaderHeight)/2 + 3, { align: 'center' });
    currentX += totalColumnWidth;
    
    // Headers de semanas
    for (let semana = 1; semana <= headerStructure.totalWeeks; semana++) {
        doc.setFillColor(25, 118, 210);
        doc.rect(currentX, y, weekColumnWidth, mainHeaderHeight, 'F');
        doc.rect(currentX, y, weekColumnWidth, mainHeaderHeight);
        doc.text(`Semana ${semana}`, currentX + weekColumnWidth/2, y + mainHeaderHeight/2 + 3, { align: 'center' });
        
        const subColumnWidth = weekColumnWidth / 4;
        let subX = currentX;
        
        ['MODULO', 'TIEMPO', 'TARIFA', 'TOTAL'].forEach(subHeader => {
            doc.setFillColor(33, 150, 243);
            doc.rect(subX, y + mainHeaderHeight, subColumnWidth, subHeaderHeight, 'F');
            doc.rect(subX, y + mainHeaderHeight, subColumnWidth, subHeaderHeight);
            
            doc.setFontSize(8);
            doc.text(subHeader, subX + subColumnWidth/2, y + mainHeaderHeight + subHeaderHeight/2 + 2, { align: 'center' });
            
            subX += subColumnWidth;
        });
        
        currentX += weekColumnWidth;
    }
    
    return mainHeaderHeight + subHeaderHeight;
};

// Función 4: Dibujar filas de datos para remanente
ARVICPDFExporter.prototype.drawRemanenteDataRow = function(doc, rowData, headers, columnWidths, y, rowIndex) {
    let currentX = 20;
    const rowHeight = 18;
    
    if (rowIndex % 2 === 0) {
        doc.setFillColor(245, 245, 245);
        doc.rect(20, y, columnWidths.reduce((a, b) => a + b, 0), rowHeight, 'F');
    }
    
    doc.setFont('helvetica', 'normal');
    doc.setFontSize(8);
    doc.setTextColor(0, 0, 0);
    
    // Total de Horas
    const totalHoras = parseFloat(rowData.totalHoras || 0).toFixed(1);
    doc.rect(currentX, y, columnWidths[0], rowHeight);
    doc.setFont('helvetica', 'bold');
    doc.text(`${totalHoras} hrs`, currentX + columnWidths[0]/2, y + rowHeight/2 + 2, { align: 'center' });
    currentX += columnWidths[0];
    
    let columnIndex = 1;
    doc.setFont('helvetica', 'normal');
    
    for (let semana = 1; semana <= 5; semana++) {
        // MODULO
        const modulo = rowData[`modulo${semana}`] || '-';
        doc.rect(currentX, y, columnWidths[columnIndex], rowHeight);
        if (modulo !== '-' && modulo !== '') {
            doc.setFontSize(7);
            doc.text(modulo, currentX + 1, y + rowHeight/2 + 2);
            doc.setFontSize(8);
        } else {
            doc.text('-', currentX + columnWidths[columnIndex]/2, y + rowHeight/2 + 2, { align: 'center' });
        }
        currentX += columnWidths[columnIndex++];
        
        // TIEMPO
        const tiempo = rowData[`tiempo${semana}`] || '0.0';
        doc.rect(currentX, y, columnWidths[columnIndex], rowHeight);
        doc.text(tiempo === '0.0' ? '-' : `${tiempo}h`, currentX + columnWidths[columnIndex]/2, y + rowHeight/2 + 2, { align: 'center' });
        currentX += columnWidths[columnIndex++];
        
        // TARIFA
        const tarifa = rowData[`tarifa${semana}`] || '$0';
        doc.rect(currentX, y, columnWidths[columnIndex], rowHeight);
        doc.text(tarifa === '$0' ? '-' : `$${tarifa}`, currentX + columnWidths[columnIndex]/2, y + rowHeight/2 + 2, { align: 'center' });
        currentX += columnWidths[columnIndex++];
        
        // TOTAL
        const total = rowData[`total${semana}`] || '$0.00';
        doc.rect(currentX, y, columnWidths[columnIndex], rowHeight);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(0, 100, 0);
        doc.text(total, currentX + columnWidths[columnIndex]/2, y + rowHeight/2 + 2, { align: 'center' });
        doc.setTextColor(0, 0, 0);
        doc.setFont('helvetica', 'normal');
        currentX += columnWidths[columnIndex++];
    }
    
    return rowHeight;
};

// Crear instancia global
window.arvicPDFExporter = new ARVICPDFExporter();

/**
 * FUNCIÓN PRINCIPAL - Exportar reporte actual a PDF
 */
async function exportCurrentReportToPDF() {
    try {
        console.log('🚀 Iniciando exportación PDF del reporte actual...');
        
        // Validar que hay datos para exportar - VERSIÓN CORREGIDA
        const reportType = window.currentReportType || currentReportType;
        const previewData = window.editablePreviewData || editablePreviewData;

        console.log('🔍 Verificando datos:', {
            reportType: reportType,
            previewDataKeys: Object.keys(previewData || {}),
            globalCurrentReportType: window.currentReportType,
            globalEditablePreviewData: window.editablePreviewData
        });

        if (!reportType || !previewData || Object.keys(previewData).length === 0) {
            throw new Error('No hay datos disponibles para exportar. Asegúrate de generar la vista previa primero.');
        }
        
        // Mostrar indicador de carga en el botón
        const pdfButton = document.getElementById('exportPDFBtn');
        if (pdfButton) {
            pdfButton.classList.add('loading');
            pdfButton.disabled = true;
        }
        
        // Preparar configuración
        const report = ARVIC_REPORTS[reportType];
        const config = {
            title: report.name || 'Reporte ARVIC',
            reportType: currentReportType,
            showTotals: true
        };
        
        // Preparar datos - convertir objeto a array
        const data = Object.values(previewData);
        
        // Preparar headers
        const headers = report.structure || ['ID', 'Descripción', 'Valor'];
        
        // Preparar metadata
        const metadata = prepareMetadataForPDF();
        
        console.log('📋 Datos preparados:', {
            config: config,
            dataCount: data.length,
            headers: headers,
            metadata: metadata
        });
        
        // Exportar PDF
        await window.arvicPDFExporter.exportToPDF(config, data, headers, metadata);
        
    } catch (error) {
        console.error('❌ Error en exportación PDF:', error);
        if (window.NotificationUtils) {
            window.NotificationUtils.error(`Error al generar PDF: ${error.message}`);
        } else {
            alert(`Error al generar PDF: ${error.message}`);
        }
    } finally {
        // Restaurar botón
        const pdfButton = document.getElementById('exportPDFBtn');
        if (pdfButton) {
            pdfButton.classList.remove('loading');
            pdfButton.disabled = false;
        }
    }
}

/**
 * Preparar metadata del reporte actual
 */
function prepareMetadataForPDF() {
    const metadata = {};
    
    // Obtener información de los filtros activos
    const clientFilter = document.getElementById('clientFilter');
    const consultantFilter = document.getElementById('consultantFilter');
    const supportFilter = document.getElementById('supportTypeFilter');
    const monthFilter = document.getElementById('monthFilter');
    
    if (clientFilter?.selectedOptions[0] && clientFilter.selectedOptions[0].value !== '') {
        metadata.cliente = clientFilter.selectedOptions[0].text;
    }
    
    if (consultantFilter?.selectedOptions[0] && consultantFilter.selectedOptions[0].value !== '') {
        metadata.consultor = consultantFilter.selectedOptions[0].text;
    }
    
    if (supportFilter?.selectedOptions[0] && supportFilter.selectedOptions[0].value !== '') {
        metadata.soporte = supportFilter.selectedOptions[0].text;
    }
    
    if (monthFilter?.selectedOptions[0] && monthFilter.selectedOptions[0].value !== '') {
        metadata.mes = monthFilter.selectedOptions[0].text;
    }
    
    return metadata;
}

// ===================================================================
// FUNCIONES DE INTEGRACIÓN CON LA INTERFAZ (RESTAURADAS)
// ===================================================================

/**
 * Añadir botón PDF al panel de configuración existente
 */
function addPDFButtonToConfigPanel() {
    // Buscar el contenedor de botones existente
    const buttonContainer = document.querySelector('.config-actions');
    
    if (buttonContainer) {
        // Verificar si el botón ya existe
        if (document.getElementById('exportPDFBtn')) {
            return; // Ya existe, no crear duplicado
        }
        
        // Crear botón PDF
        const pdfButton = document.createElement('button');
        pdfButton.className = 'btn btn-info btn-pdf';
        pdfButton.id = 'exportPDFBtn';
        pdfButton.innerHTML = '<span class="btn-icon">📄 Exportar PDF</span>';
        pdfButton.onclick = exportCurrentReportToPDF;
        pdfButton.disabled = true; // Inicialmente deshabilitado
        
        // Insertar después del botón de Excel
        const excelButton = document.getElementById('generateBtn');
        if (excelButton) {
            excelButton.parentNode.insertBefore(pdfButton, excelButton.nextSibling);
        } else {
            buttonContainer.appendChild(pdfButton);
        }
        
        console.log('✅ Botón PDF añadido al panel de configuración');
    }
}

// Función auxiliar para verificar cuántas filas caben por página
function calculateMaxRowsPerPage() {
    const pageHeight = 210; // A4 landscape
    const usableHeight = pageHeight - PDF_CONFIG_OPTIMIZED.headerHeight - 50; // 50 para footer
    const averageRowHeight = 12; // Altura promedio por fila
    
    return Math.floor(usableHeight / averageRowHeight);
}

console.log(`📋 Filas estimadas por página: ${calculateMaxRowsPerPage()}`);

/**
 * Actualizar estado del botón PDF (habilitar/deshabilitar)
 */
function updatePDFButtonState(enabled) {
    const pdfButton = document.getElementById('exportPDFBtn');
    if (pdfButton) {
        pdfButton.disabled = !enabled;
        console.log(`🔄 Botón PDF ${enabled ? 'habilitado' : 'deshabilitado'}`);
    }
}

function debugRemanenteData() {
    console.log('🔍 DEBUGGING - Estructura de datos remanente');
    
    if (!editablePreviewData || Object.keys(editablePreviewData).length === 0) {
        console.error('❌ No hay datos en editablePreviewData');
        return;
    }
    
    const firstRow = Object.values(editablePreviewData)[0];
    console.log('📊 Primera fila de datos:', firstRow);
    
    // Verificar estructura de semanas
    const semanaKeys = Object.keys(firstRow).filter(key => key.startsWith('semana'));
    console.log('📅 Semanas encontradas:', semanaKeys);
    
    semanaKeys.forEach(semanaKey => {
        console.log(`📅 ${semanaKey}:`, firstRow[semanaKey]);
    });
    
    // Verificar total de horas
    console.log('📊 Total de horas:', firstRow.totalHoras);
    
    return {
        totalRows: Object.keys(editablePreviewData).length,
        semanas: semanaKeys.length,
        estructura: firstRow
    };
}

function debugRemanenteStructure() {
    console.log('🔍 DEBUGGING COMPLETO - Estructura Remanente');
    
    if (!window.editablePreviewData) {
        console.error('❌ No hay editablePreviewData disponible');
        return;
    }
    
    const data = window.editablePreviewData;
    const firstRow = Object.values(data)[0];
    
    console.log('📊 Primera fila completa:', firstRow);
    
    if (firstRow && firstRow.monthStructure) {
        console.log('📅 Estructura de mes:', firstRow.monthStructure);
        
        const semanaKeys = Object.keys(firstRow).filter(key => key.startsWith('semana'));
        console.log('📅 Semanas encontradas:', semanaKeys);
        
        semanaKeys.forEach(key => {
            console.log(`📅 ${key}:`, firstRow[key]);
        });
        
        // Probar transformación
        const transformed = transformRemanenteDataForPDF(data);
        console.log('🔄 Resultado de transformación:', transformed);
        
        return {
            originalData: Object.keys(data).length,
            semanas: semanaKeys.length,
            transformedHeaders: transformed.headers.length,
            transformedData: transformed.data.length
        };
    } else {
        console.error('❌ No se encontró monthStructure en los datos');
        return null;
    }
}

// ===================================================================
// HOOKS PARA INTEGRACIÓN AUTOMÁTICA (CRÍTICOS PARA EL FUNCIONAMIENTO)
// ===================================================================

/**
 * Hook en la función de configuración existente
 */
const originalShowConfigPanel = window.showConfigPanel;
if (originalShowConfigPanel) {
    window.showConfigPanel = function(...args) {
        const result = originalShowConfigPanel.apply(this, args);
        setTimeout(addPDFButtonToConfigPanel, 100); // Añadir botón después de crear panel
        return result;
    };
}

/**
 * Hook en la validación de filtros existente
 */
const originalValidateRequiredFilters = window.validateRequiredFilters;
if (originalValidateRequiredFilters) {
    window.validateRequiredFilters = function(...args) {
        const result = originalValidateRequiredFilters.apply(this, args);
        
        // Obtener estado actual de los botones
        const generateBtn = document.getElementById('generateBtn');
        const enabled = generateBtn && !generateBtn.disabled;
        
        // Actualizar botón PDF
        updatePDFButtonState(enabled);
        
        return result;
    };
}

/**
 * Hook en la generación de vista previa
 */
const originalGenerateReportPreview = window.generateReportPreview;
if (originalGenerateReportPreview) {
    window.generateReportPreview = function(...args) {
        const result = originalGenerateReportPreview.apply(this, args);
        
        // Habilitar botón PDF después de vista previa exitosa
        setTimeout(() => {
            const previewPanel = document.getElementById('reportPreviewPanel');
            if (previewPanel && previewPanel.innerHTML.trim() !== '') {
                updatePDFButtonState(true);
                console.log('✅ Vista previa generada - Botón PDF habilitado');
            }
        }, 500);
        
        return result;
    };
}

// ===================================================================
// FUNCIONES GLOBALES Y DE UTILIDAD
// ===================================================================

/**
 * Función para exportar cualquier tabla HTML a PDF
 * Útil para casos especiales o futuras expansiones
 */
async function exportTableToPDF(tableElement, title = 'Reporte ARVIC', metadata = {}) {
    if (!tableElement) return;
    
    const headers = Array.from(tableElement.querySelectorAll('thead th')).map(th => th.textContent.trim());
    const rows = Array.from(tableElement.querySelectorAll('tbody tr')).map(tr => 
        Array.from(tr.querySelectorAll('td')).map(td => td.textContent.trim())
    );
    
    const config = {
        title: title,
        reportType: 'custom',
        showTotals: false
    };
    
    await window.arvicPDFExporter.exportToPDF(config, rows, headers, metadata);
}

// Funciones principales
window.exportCurrentReportToPDF = exportCurrentReportToPDF;
window.exportTableToPDF = exportTableToPDF;
window.addPDFButtonToConfigPanel = addPDFButtonToConfigPanel;
window.updatePDFButtonState = updatePDFButtonState;
window.debugRemanenteData = debugRemanenteData;
window.debugRemanenteStructure = debugRemanenteStructure;

// Inicialización automática
document.addEventListener('DOMContentLoaded', function() {
    console.log('✅ Sistema de exportación PDF ARVIC cargado exitosamente');
    
    // Verificar si ya existe un panel de configuración visible
    const configPanel = document.getElementById('reportConfigPanel');
    if (configPanel && configPanel.style.display !== 'none') {
        addPDFButtonToConfigPanel();
    }
    
    // Verificar integración con funciones existentes
    setTimeout(() => {
        if (typeof validateRequiredFilters !== 'function') {
            console.warn('⚠️  Función validateRequiredFilters no encontrada - integración parcial');
        }
        
        if (typeof generateReportPreview !== 'function') {
            console.warn('⚠️  Función generateReportPreview no encontrada - integración parcial');
        }
        
        console.log('🔗 Verificación de integración completada');
    }, 1000);
});

console.log('📄 ARVIC PDF Exporter v3.0 - Sistema completo con diseño exacto iniciado exitosamente');